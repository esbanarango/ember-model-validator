<div class="ui masthead vertical segment">
  <div class="ui container">
    <div class="introduction">
      <h1 class="ui header">
        Relations
        <div class="sub header">
          This validator will run the <strong>validate()</strong> function for the specific relation. If it's a <code class="ui label">DS.hasMany</code> relation then it will loop through all objects.
        </div>
      </h1>
      <div class="ui hidden divider"></div>
      <p>
        The relations have to be embedded or the <a href="https://emberjs.com/api/ember-data/release/classes/DS.EmbeddedRecordsMixin"><code class="ui label">embedded</code></a> has to be already resolved.
      </p>
    </div>
  </div>
</div>

<div class="ui main container">
  <p>
    {{! template-lint-disable block-indentation }}
    <UiAnnotation @showing={{true}} @type="javascript">
validations = {
  myHasManyRelation: {
    relations: ["hasMany"]
  },
  myBelongsToRelation: {
    relations: ["belongsTo"]
  }
};
    </UiAnnotation>
    {{! template-lint-enable }}
  </p>

  <ConfigOptions @defaultMessage={{messages.acceptanceMessage}} />

  <UiExample @header="Examples" @subHeader="A form with some required inputs" as |showing setCopyCode|>

    <UiHtml @showing={{showing}}>
      <div class="ui two column grid">
        <div class="column">
          <h5>Relation model</h5>
          <ObjectForm @for={{modelRelation}} @classNames="segment">
            <FormField @for="fullName" @label="Full Name" @required={{true}}>
              <Input @value={{modelRelation.fullName}} placeholder="Full Name" />
            </FormField>
            <div class="fields">
              <div class="field">
                <FormField @for="fruit" @label="Favorite Fruit" @required={{true}}>
                  <UiDropdown @class="selection" @selected={{modelRelation.fruit}} @onChange={{action (mut modelRelation.fruit)}}>
                    <div class="default text">Fruit</div>
                    <i class="dropdown icon"></i>
                    <div class="menu">
                      <div class="item"></div>
                      {{#each fruits as |fruit|}}
                        <div class="item" data-value={{fruit}}>
                          {{fruit}}
                        </div>
                      {{/each}}
                    </div>
                  </UiDropdown>
                </FormField>
              </div>
              <div class="field">
                <FormField @for="color" @label="Favorite Color">
                  <Input @value={{modelRelation.color}} placeholder="Favorite Color" />
                </FormField>
              </div>
            </div>
          </ObjectForm>
          <h5>Main model</h5>
          <ObjectForm @for={{model}} @classNames="segment">
            <p>
              Duis aute irure dolor in reprehenderit in voluptate velit esse
              cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
              proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            </p>

            <FormField @for="happyWithMyRelation" @label="Are you happy?" @required={{true}}>
              <UiCheckbox @class="toggle" @label="Yeah!" @checked={{model.happyWithMyRelation}} @onChange={{action (mut model.happyWithMyRelation)}} />
            </FormField>
            <div class="actions">
              <div class="ui input submit">
                <button class="ui button primary mr-10" {{action "validate"}}>Validate</button>
                <button class="ui button reset" {{action "reset"}}>Reset</button>
              </div>
            </div>
          </ObjectForm>

        </div>
        <div class="column">
          <div class="ui segment">
            <ModelErrorsToJson @errors={{modelRelation.errors}} @modelName="for-presence" />
            <ModelErrorsToJson @errors={{model.errors}} @modelName={{modelName}} />
          </div>
        </div>
      </div>
    </UiHtml>
    {{! template-lint-disable block-indentation }}
    <UiAnnotation @showing={{showing}} @type="javascript" @setCopyCode={{setCopyCode}}>
import Model from 'ember-data/model';
import attr from 'ember-data/attr';
import { belongsTo } from 'ember-data/relationships';
import Validator from 'ember-model-validator/decorators/model-validator';

@Validator
class MyModel extends Model {
  @belongsTo('specifics.for-presence') relationYeah;
  @attr('boolean') happyWithMyRelation;

  validations = {
    happyWithMyRelation: {
      acceptance: true,
    },
    relationYeah: {
      relations: ['belongsTo'],
    },
  };
}

export default MyModel;
    </UiAnnotation>
    {{! template-lint-enable }}
  </UiExample>
</div>
